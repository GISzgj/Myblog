<!DOCTYPE html>
<html class='theme-container'>

<head>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    

    <title>使用QGIS对静安区coffee进行商圈分析</title>

    <link rel="canonical" href="http://zgjgis.top/">

    
    <link rel='stylesheet' type='text/css' href='/css/common.min.2e0fcb1a7000d167fb8edc8795fd7fa375f12491a92c7e9c4e7cbaabf45d4c90.css'/>
    
    <link rel='stylesheet' media='screen and (min-width: 1201px)' type='text/css'
          href='/css/normal.min.31aebf352f9ce7e94065b4d20477665d772393827a9185be8575521ab89ce57b.css'/>
    
    <link rel='stylesheet' media='screen and (max-width: 1200px)' type='text/css'
          href='/css/small.min.e47b2efc4087d6f608db7a76b068966259b87238bb82e48604c1eac68e99b6a8.css'/>

    
    <link rel='stylesheet' type='text/css' href='/css/androidstudio.min.min.c0869a17349d3f1bdd078763e8c11ec9808c9f38239bb254720577662fba87bf.css'/>
    
    <script src="/js/highlight.min.min.155085ac1988f2e38adba549807cd185e0d299b9eaea28270e24933bfa77bda9.js"></script>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<script>
    hljs.highlightAll();
</script>
<body>

<div class="top">
    <a href="/">
        <img src="/img/logo.png"/>
    </a>
    <nav>
        
        <a href="/blog/">
            技术博客
        </a>
        
        <a href="/projects/">
            项目
        </a>
        
        <a href="/life/">
            生活
        </a>
        
        <a href="/about">
            简历介绍
        </a>
        
    </nav>
</div>

<div id="center" class='center' >
    
<header class="center_head">
    <h1>
    使用QGIS对静安区coffee进行商圈分析
</h1>
<div style="text-align: center;opacity: 0.5;margin-top: 0.5em;">
    2022.09.20 09:25
</div>
</header>

    
<div class="center_main">
    <a href="../" class="center_main_contents_left">
        <h1>My Blog</h1>
    </a>
    <style>
    .content_post h2::before {
        content: "※ ";
    }

    .content_post h3::before {
        content: "✧ ";
    }
</style>
<article class="content_post heti heti--ancient">
    <h2 id="一绪论">一．绪论</h2>
<p>主要目的是将上海市静安区的研究区域内的咖啡馆全部提取出来，在qgis中完成商圈可视化分析，以及商圈内的人口与公共设施（公交）的定量分析。</p>
<p>任务需要搜集相关的数据完成GIS 数据的导入与制作，然后进行临近区域的制作与可视化，最后完成临近区域属性的空间分析。</p>
<p>商品的流通与地理空间密切相关。我们可以将商业视为连接产地、储存地、销售地与消费者居住地之间的一条渠道。这条渠道能否能够高效率、低成本地将商品传送到消费者手中，不仅取决于流通渠道本身，而且取决于流通渠道周边的自然地理与人文地理的关联属性。本次设计对象聚焦于商品流通渠道的末端——商圈。商圈是以某个商店为中心，平时来此购物的消费者的生活及活动的范围。</p>
<p>因此，商圈分析的实质是对点状地物（这里指商铺）的临近空间的分析。本</p>
<p>设计具体以上海市某区的店铺为对象，运用 GIS 工具分析其商圈特征。先分析店铺商圈的主要特点。城市中心店铺林立，同类竞争店的存在是第一份特点。第二个特点是，竞争店商品的无差异化。因此，消费者决定去哪家店铺购物，一般取决于消费者与店铺的邻近性，如距离与时间，而并非商品的差异化。基于这样的基本观点，本设计以商圈的便利性和竞争性为出发点，介绍商圈范围的可视化，以及商圈内的人口与公共设施的定量分析方法。</p>
<h2 id="二理论基础">二．理论基础</h2>
<ol>
<li>
<p>坐标系统与重投影：</p>
<p>GIS的一个基本原则是：要在一起使用的图层必须在空间上相互匹配，否则就会发生明显错误。需要使用重投影将图层放置到统一的坐标系统之下。</p>
<p>投影是将数据集从地理坐标转换成投影坐标。重投影是从一种投影坐标转换成另一种投影坐标。通常投影与重投影是GIS项目的初始任务。</p>
<p>基本概念：GIS地理坐标系是以经纬度为单位的地球坐标体系。地理坐标系中有2个重要部分，即地球椭球体和大地基准面。因为地球表面的不规则性，地球椭球体不能用数学公式来表达，也就无法施行运算，所以有必要找一个形状和巨细都很挨近地球的椭球体来替代地球，这个椭球体被称为地球椭球体。</p>
<p>投影坐标系在二维平面中进行界说。与地理坐标系不同，在二维空间范围内，投影坐标系的长度、视点和面积稳定。投影的必要条件是：榜首、任何一种投影都有必要依据一个椭球（地球椭球体），第二、将球面坐标转换为平面坐标的进程（投影算法）。</p>
</li>
<li>
<p>矢量数据要素：</p>
<p>矢量数据结构表示地球表面的特定要素，并为这些要素分配属性。矢量由称为折点的离散几何位置（x、y 值）组成，这些位置定义了空间对象的形状。折点的组织决定了我们使用的矢量类型：点、线或多边形。</p>
<p>点（Points）：每个点是由单独的X,Y坐标定义的，在一个点矢量文件中可以包含多个点。点数据可以包含：采样点、独立树、测量点等等。</p>
<p>线（Lines）：线是一系列（至少2个）相连的折点或点的集合。道路、溪流都可以以线的形式表现。线包含一系列的线段或弧，每段线都是由折点的X,Y坐标所定义的。</p>
<p>面（Polygons）：面是由3个或以上的折点组成的连续封闭图形。建筑物、湖泊、海洋、国家等等都可以以面来表示。</p>
</li>
<li>
<p>GIS数据的获取：</p>
<p>通过各大地图网站直接获取信息。通过使用爬虫，或者一些其他的软件或网页，如八爪鱼以及规划云。</p>
</li>
<li>
<p>空间数据查询：</p>
<p>定义：从GIS数据库中找出所有属性约束条件和空间约束条件的地理对象或数据内容。数据查询是GIS的一个非常重要的功能，定位空间对象、提取对象信息，是地理信息系统进行高层次空间分析的基础。</p>
<p>大致可以分为四类：</p>
<p>针对空间特征的查询，基于属性数据的查询，结合空间关系和非空间关系的查询，地址匹配查询</p>
</li>
<li>
<p>缓冲区分析：</p>
<p>缓冲区分析：就是空间实体的一种影响范围或服务范围，缓冲区分析的基本思想是给定一个空间实体或集合，确定它们的领域，领域的大小由领域半径来确定。</p>
<p>原理：无论是点缓冲、线缓冲、面缓冲都要形成一个缓冲条件（包括：指定缓冲距离、以要素确定距离…..）包括建立和分析两部分。</p>
<p>缓冲区分析是地理信息系统最重要和最基本的空间分析功能之一。对一组或一类地理要素按设定的距离条件，在其范围生成具有一定宽度范围的多边形区域（缓冲区），通过分析区内的空间数据，以获取数据在二维空间扩展的信息。</p>
<p>点的缓冲：</p>
<p>1.单点定距缓冲：以点为圆心，往往得到一个圆形。</p>
<p>​          2.单点多距缓冲：形成一个多距缓冲。</p>
<p>3.多级缓冲（用途最多）：根据应用目的，指定级别数及间距，在分析范围内的缓冲区为每一个目标点建立多级缓冲区。</p>
<p>4.按属性值缓冲：根据应用目的，选中作为缓冲距离的属性字段，在分析范围内的缓冲区为每一个目标点建立以属性字段值为缓冲距离的缓冲区。</p>
</li>
<li>
<p>泰森多边形：</p>
<p>泰森多边形又叫冯洛诺伊图（Voronoi diagram），得名于Georgy Voronoi，是一组由连接两邻点线段的垂直平分线组成的连续多边形组成。泰森多边形是对空间平面的一种剖分，其特点是多边形内的任何位置离该多边形的样点（如居民点）的距离最近，离相邻多边形内样点的距离远，且每个多边形内含且仅包含一个样点。由于泰森多边形在空间剖分上的等分性特征，因此可用于解决最近点、最小封闭圆等问题，以及许多空间分析问题，如邻接、接近度和可达性分析等。</p>
</li>
<li>
<p>合并、关联和关系类：</p>
<p>为利用关系数据库，可以把数据库中的表格链接起来，进行数据查询和管理。三种链接表格：合并、关联和关系类。</p>
<p>合并：是用两个表格的一个共同关键字或者主关键字和外部关键字把两个表格连在一起。</p>
<p>关联：关联操作只是临时性的把两个表格连接在一起。而各表格保持独立。</p>
<p>​        关系类：基于对象模型如geopandas可以支持对象之间的关系。</p>
</li>
<li>
<p>地图叠置：</p>
<p>叠置分析：将有关主题层组成的各个数据层进行叠置产生一个新的数据层面，其结果综合 了原来两个或多个层面要素所具有的属性，同时叠置分析不仅生成了新的空间关系，而且还将输入的多个数据层的属性联系起来产生了新的属性关系。</p>
<p>点与多边形的叠置：结果往往是将其中一个图层的属性信息注入到另一个图层中，然后更新得到的数据图层。（首先计算多边形对点的包含关系—&gt;进行属性信息的处理），可以查询每个多边形有多少个点。点对多边形的包涵：对点的x轴做垂线，如果与多边形相交于偶数点则在多边形内。</p>
<p>线与多边形的叠置：线图层叠置在多边形图层上，确定一条线落在哪个多边形内。线具有长度，可能被多边形分割。</p>
<p>多边形与多边形的叠置：将两个或多个多边形叠加，产生一个新的多边形图层。（合并：保留两个输入图层的所有多边形；叠合：以输入图层为界，保留边界内两个多边形的所有多边形；相交：只保留两个输入图层的公共区域）</p>
</li>
<li>
<p>可视化（分层设色）：</p>
<p>可视化是将数据进行处理，将其直观地表示出来一般转化为图像。
​   在本次设计中就是将不同级别的数据分别设置一个颜色。更加直观。
根据等高线划分出地形高程带，并逐层设定不同颜色，以色调及色度之逐渐变化，直接反映高程带数量与特徵变化的方法称之。就是将不同级别的数据分别设置一个颜色。本法能提供快速高程判读，及图上最高与最低的地形之讯息。高程设色色段数之选择，主要是按等高线间隔，以便能显示最佳之地形呈现。见分层设色。</p>
</li>
</ol>
<h2 id="三设计步骤">三．设计步骤</h2>
<h3 id="1-获取研究区域咖啡馆信息并绘制表格">1. 获取研究区域咖啡馆信息，并绘制表格</h3>
<p>利用python爬虫，爬取上海静安区的所有coffee馆的信息。</p>
<p>爬虫使用高德地图api接口，利用python爬取coffee的基本信息如姓名位置坐标。</p>
<p>最后爬取的结果保存为csv格式，再通过excel来处理信息。</p>
<p>备注：爬取的结果数目大于研究区域的数目，需要在QGIS里用空间信息查询，将研究区域以外的点删除。</p>
<p>也可以使用八爪鱼软件来爬取数据（等时圈同样也可以使用。）</p>
<p>图表 0.1爬取coffee信息</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis1.png" alt="img"></p>
<p>通过excel将爬取的信息进行处理，关键是将location的信息转化出X,Y输出coffee的位置信息。使用的excel函数为mid（）和right（）对location进行处理添加X、Y两列。结果共有551条数据。</p>
<p>处理的部分结果如下：</p>
<p>图表 0.2信息处理结果</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis2.png" alt="img"></p>
<p>图表 0.3部分结果</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis3.png" alt="img"></p>
<h3 id="2-导入数据">2. 导入数据</h3>
<p>导入数据时要使用.csv格式。先将excel处理后的数据转化为txt格式，再把txt中的空格全部转化为“，”然后将数据转化为csv格式，编码设置为utf-8。</p>
<p>在QGIS中，点击图层，添加图层，添加分隔文本图层。导入csv文件将X,Y作为点的位置输出。</p>
<p>利用空间信息查询将不在研究范围的点全部删除，操作是在工具栏中选择按位置选择，将点数据放入第一个图层，将研究面图层放入第二个，选择不不相交于，将选中的点全部删除。最后只留下研究区内的coffee点。</p>
<p>然后进行重投影，点击矢量 、数据管理工具、重投影图层。将图层的地理坐标系统设置为2385-Xian 1980。（之后的每一个图层都需要重投影将其转换到同一个坐标系统之下。）</p>
<p>图表 0.4导入数据</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis4.png" alt="img"></p>
<p>图表 0.5重投影</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis5.png" alt="img"></p>
<p>图表 0.6导入结果</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis6.png" alt="img"></p>
<h3 id="3-要素转换">3. 要素转换</h3>
<p>导入boundary（现状行政边界数据）数据将其转换为面状要素并命名为stb_boundary，以便后续用于空间分析和计算。</p>
<p>在工具箱搜索多边形化，使用多边形化工具将boundary线要素转化为面要素。</p>
<p>正常来说也要使用同样的方法将city_town从线状数据转换为面状数据。</p>
<p>但是因为课设给的数据中city_down直接是面状工具，因此，不需要将在使用上述过程来转换要素类型。</p>
<p>图表 0.7转化要素</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis7.png" alt="img"></p>
<h3 id="4-创建缓冲区">4. 创建缓冲区</h3>
<p><strong>（1）</strong>  <strong>建立等距缓冲区和等时缓冲区。</strong></p>
<p>等距缓冲区使用缓冲区工具，在设置中将距离设置为100米，输入图层选择coffee点数据。</p>
<p>等时缓冲区使用python代码，利用mapbox的api接口，因为无法直接设置速度，因此使用出行方式walking来代替，再加一个参数输入坐标，将coffee的一个点的坐标输入进去计算等时缓冲区，并输出shp格式，可直接导入QGIS中。导入后双击进入属性，符号化将颜色的不透明度调低，方便观察。</p>
<p>缓冲区创建时可以创建单独的缓冲区，也要把融合的缓冲区建立出来，方便后期的面积计算。</p>
<p>如果创建缓冲区时只创建了单独缓冲区，可以从工具栏中搜索融合工具，输入图层设为单独缓冲区，然后输出，将所有字段融为一体，最后只剩下一个字段，也是融合缓冲区。</p>
<p>图表 0.8等时区的获取</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis8.png" alt="img"></p>
<p>图表 0.9缓冲区的建立</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis9.png" alt="img"></p>
<p><strong>（2）</strong>  <strong>使用clip裁剪工具。</strong></p>
<p>在工具栏中直接搜索clip，打开clip工具。输入图层为融合缓冲区，叠加图层为stb_boundary。</p>
<p>靠近边界部分的缓冲区超出了边界线的范围，利用clip裁剪工具将超出的部分删除。只留下在缓冲区里的部分，便于研究。</p>
<p>图表 0.10裁剪后</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis10.png" alt="img"></p>
<p><strong>（3）</strong>  <strong>计算缓冲区面积。</strong></p>
<p>计算缓冲区的面积，在缓冲区分析结果图层中添加area面积字段，将字段名称设置为“area”，类型设置为小数（实型）“Decimal number（real）”，精度（precision）设置为3 .（备注：因为我的QGIS无法设置精度，因此精度为最高的，最后再进行换算）</p>
<p>在Expression右侧的Geometry空间计算公式列表中选择面积计算函数$area,</p>
<p>手动输入“$area/1000000”，将基于投影坐标系计算的多边形面积的默认单位“平方米”，转换为“平方千米”。</p>
<p>图表 0.11缓冲区面积</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis11.png" alt="img">（没有设置精度)</p>
<h3 id="5--创建泰森多边形">5.  创建泰森多边形</h3>
<p>加载 boundary 文件，将其转化为面图层，确定研究区位与边界，方便后期裁剪泰森多边形。</p>
<p>在工具框里搜索泰森多边形工具，打开并设置以下参数并执行：输入图层选择coffee馆的点数据“coffee”，缓冲工具（占范围百分比）设定为“25”，以便覆盖整个研究区。</p>
<p>结果生成 Voronoi_polygons（泰森多边形） 图层，将该图层移动到coffee图层之下。</p>
<p>利用研究区边界图层，使用裁剪clip工具裁剪泰森多边形分析结果中超出研究区范围的部分，只留下研究区域内的部分。裁剪后的数据存储为“coffee_voronoi”。</p>
<p>图表 0.12泰森多边形结果</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis12.png" alt="img"></p>
<p>思路：基于人口栅格数据的商圈人口估算</p>
<p>以下步骤的整体思路是：</p>
<p>（1）利用 QGIS 的交叉计算工具，将邻近区域（缓冲区或泰森多边形区</p>
<p>域）与人口栅格数据进行交叉运算。</p>
<p>（2）对交叉区域进行人口估算（按下列公式）</p>
<p>交叉区域人口=栅格人口*交叉区域面积/栅格面积</p>
<p>（3）以邻近区域为单位，如以泰森多边形为单位，将交叉区域人口数综</p>
<p>合。</p>
<h3 id="6--对栅格人口及泰森多边形计算每个单元数据的面积">6.  对栅格人口及泰森多边形计算每个单元数据的面积</h3>
<p>在 Jingan_pop2015 栅格数据属性表内打开字段计算器，添加一个新字段，字段字段名称设置为area，将字段设置为小数（实型），精度不进行设置（同上）在表达式的搜索框里搜索选择面积计算函数$area,如果除以1000000结果太小，基本为零，因此不进行设置。</p>
<p>图表 0.13人口面积</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis13.png" alt="img"></p>
<h3 id="7--栅格人口数据与泰森多边形数据的交叉计算">7.  栅格人口数据与泰森多边形数据的交叉计算</h3>
<p>（1）相交人口数据与泰森多边形</p>
<p>矢量→地理处理工具→相交。计算人口数据和泰森多边形的相交部分</p>
<p>（输入图层）为栅格人口数据 。</p>
<p>（叠加图层）为泰森多边形数据。计算并输出成文件，设置文件名为“store_voronoi_pop_intersection”。</p>
<p>图表 0.14相交图</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis202209201108913.png" alt="img"></p>
<p>（2）计算每一个交叉部分的面积</p>
<p>打开store_voronoi_pop_intersection图层的属性表，选择打开字段计算器，输出字段设置为“area_v”，类型设置为小数（实型）精度默认。在函数的搜索框里搜索并使用$area.计算每一个交叉部分的面积。</p>
<p>图表 0.15交叉部分的面积</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis16.png" alt="img"></p>
<h3 id="8--交叉区域的人口估算">8.  交叉区域的人口估算</h3>
<p>再次打开store_voronoi_pop_intersection图层的属性表。在属性表里打开字段计算器，计算交叉区域人口数量。</p>
<p>输出字段名字设置为“pop_int”</p>
<p>输出字段类型设置为为“小数（实型）”输出字段长度与精度，因为我的QGIS无法设置数值，因此全都使用默认值。</p>
<p>表达式设置为“area_v * pop / area”。计算交叉区域的人口估计数量。</p>
<p>图表 0.16交叉区域的人口估算</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis17.png" alt="img"></p>
<h3 id="9--泰森多边形商圈的人口估算">9.  泰森多边形商圈的人口估算</h3>
<p>（1） 输出图层，csv格式</p>
<p>右键store_voronoi_pop_intersection图层，选择导出，要素另存为，选择格式为csv格式，将文件命名为tb_voronoi_pop.csv然后输出。</p>
<p>图表 0.17输出csv</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis18.png" alt="img"></p>
<p>（2） 数据处理，计算人口</p>
<p>在excel打开输出的csv文件，转换为xlsx文件，使用分类汇总的功能，以名字字段为分类的依据，将每个名字字段下的pop_int汇总在一起输出成新字段‘人口总和’。</p>
<p>然后将excel表转存为csv格式，并命名为tb_voronoi_pop.csv。</p>
<p>图表 0.18人口总和</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis19.png" alt="img"></p>
<p>（3） 连接属性表，绘制分布图</p>
<p>在工具栏中搜索“按字段值连接属性”，打开工具</p>
<p>输入图层1设置为：store_voronoi_pop_intersection</p>
<p>输入图层2设置为：tb_voronoi_pop.csv</p>
<p>要复制的图层2字段选择为：人口总和</p>
<p>然后输出名字设置为：“人口密度分布图”，完成属性表的链接。</p>
<p>然后对“人口密度分布图”图层进行分层设色，双击打开属性，选择符号化，渐进，字段选择为：“人口总和”点击自然间断点。</p>
<p>图表 0.19人口密度分布</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis20.png" alt="img"></p>
<h3 id="10-商圈缓冲区内的公交站数的计算">10. 商圈缓冲区内的公交站数的计算</h3>
<p>（1）叠置运算（相交）</p>
<p>​       在工具栏中搜索相交，或者矢量→地理处理工具→相交。打开相交，将泰森多边形和融合缓冲区进行相交运算。输出图层名字为：“商圈缓冲区”</p>
<p>图表 0.20商圈缓冲区</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis21.png" alt="img"></p>
<p>（2）统计公交站个数</p>
<p>在搜索框里搜索“统计点在多边形中的数量”或者矢量，分析工具，统计点在多边形中的数量。打开后输入两个图层分别是“bus_stop”和“商圈缓冲区”统计结果放入字段：“NUMPOINTS”。然后输出图层为：“公交站数”</p>
<p>图表 0.21公交站数</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis22.png" alt="img"></p>
<p>（3）分层设色</p>
<p>​       双击“公交站数”图层打开属性，点击符号化，选择分类，值为：“NUMPOINTS”点击分类。分层设色结果图为：</p>
<p>图表 0.22公交站分层设色</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis202209201111455.png" alt="img"></p>
<h2 id="四成果展示">四．成果展示</h2>
<h3 id="1独立等距缓冲区和融合等距缓冲区">1.独立等距缓冲区和融合等距缓冲区</h3>
<p>根据研究区域裁剪后的独立等距缓冲区和融合等距缓冲区。</p>
<p>独立等距缓冲区</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis23.png" alt="img"></p>
<p>融合等距缓冲区</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis25.png" alt="img"></p>
<h3 id="2等时圈分布">2.等时圈分布</h3>
<p>只取了一个点的等时圈，等时圈的计算方式为：walking，时间为</p>
<p>2min</p>
<p>等时圈</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis24.png" alt="img"></p>
<h3 id="3泰森多边形商圈的人口密度分布图">3.泰森多边形商圈的人口密度分布图</h3>
<p>采用渐进的分层方法，一共将人口密度分成10层，从低到高层层颜色加深。人口密度越多，颜色越深的coffee馆，其周围人口较多，竞争力会比其它人口密度低的店铺大。</p>
<p>人口密度分布图</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis202209201111546.png" alt="img"></p>
<h3 id="4商圈缓冲区的公交站数分布图">4.商圈缓冲区的公交站数分布图</h3>
<p>浅粉色的公交站数量为：0</p>
<p>稍深粉色的公交站数量为：1</p>
<p>深红色的公交站数量为：2</p>
<p>公交站数量越多的coffee馆的竞争力越大。</p>
<p>公交站数分层设色</p>
<p><img src="https://imagesgis.oss-cn-hangzhou.aliyuncs.com/img/img/qgis26.png" alt="img"></p>
<h2 id="五-不足与展望">五． 不足与展望</h2>
<h3 id="1设计过程中碰到的问题及解决办法">1.设计过程中碰到的问题及解决办法</h3>
<ul>
<li>
<p>（1）问题：研究区域coffee馆数据的获取困难。数据太多无法一个一个输入。</p>
<pre><code>解决：利用python爬虫直接在高德地图网站爬取静安区数据。Api为高德地图的。利用python的requests库可以直接将研究区域的咖啡馆信息如名称，地址，位置，经纬度，城市名字等信息爬取下来，并保存到csv文件中，直接导入QGIS转为为矢量文件。
</code></pre>
</li>
<li>
<p>（2）问题：.csv文件格式导入QGIS中出现乱码，中文无法正常显示。</p>
<pre><code>解决：原因是因为编码格式问题，需要将.csv的编码格式转化为utf-8。做法：将.csv文件用txt文本打开，点击另存为，注意将编码格式修改为utf-8编码格式。​    
</code></pre>
</li>
<li>
<p>（3）问题：坐标系的转换与统一问题。最开始转换坐标系的时候是通过属性里的源直接更改指定坐标参照系，会使得图层剧烈偏移无法对齐。</p>
<p>​    解决：坐标系的转换要通过重投影来进行。在工具框里直接搜索重投影，或者在矢量、数据管理工具、重投影图层。
​    打开后选择图层和目标坐标系。通过修改工程CRS为目标坐标系来使整个工程的坐标系统一。</p>
</li>
<li>
<p>（4）问题：等时缓冲区的制作，完全不会。</p>
<p>​    解决：通过查找资料，发现可以使用mapbox的api接口来计算等时圈，需要使用python的爬虫代码，通过注册mapbox网站，阅读 相关的文档将python的爬虫代码写出来。然后输入一个coffee馆的位置坐标将，这个店铺的等时圈画出来（出行方式：walking 时间：2min），直接生成.shp文件，导入QGIS中。</p>
</li>
<li>
<p>（5）问题：在字段计算器里，各种数据类型全都无法设置长度和精度。</p>
<pre><code>无法解决：可能通过重装QGIS可以解决，但是没有时间就没有尝试。
</code></pre>
</li>
<li>
<p>（6）问题：在将交叉区域的图层输出为.csv后，不会利用Excel计算每个coffee馆的服务人口的总和。</p>
<p>​    解决：在查找资料，明白这是一个分类统计的问题，将具有相同名字的pop_int相加求和，输出新字段“人口总和”。具体操作，在数据中的分级显示中选择分类汇总在“分类汇总”对话框中，分类字段表示要进行分类汇总的字段，汇总方式中可选以计数、求和、平均值等汇总方式，选定汇总项：表示要根据实际进行汇总的数据。根据需要算则即可</p>
</li>
</ul>
<h3 id="2本设计能够应用在哪些方面解决哪些问题">2.本设计能够应用在哪些方面、解决哪些问题</h3>
<p>可以使用在新店铺选址上，选取交通便利，人口密度大的区域。</p>
<p>可以应用于竞争力分析中，分析那些店铺资源位置好，竞争力强。</p>
<p>可以使用在项目前期策划报告的可行性研究中，用来分析市场情况。收集数据，并将数据展示出来。</p>
<p>可以使用在市场开拓战略中。企业策略的制定或调整，要立足于商圈内环境因素的现状以及发展趋势。本次设计，可以帮助经营者制定适宜的市场开拓战略，不断延伸经营触角，扩大商圈范围，提高市场占有率。</p>
<h3 id="3gis-在商圈分析中还有哪些应用">3.GIS 在商圈分析中还有哪些应用</h3>
<p>(1)商业活动与地理单元及区域社会、经济、自然、人文等密切联系，而处理和分析地理数据信息GIS的具有强大的功能，应用GIS数据库中的资料及其有关功能，辅之以相应的市场及商业信息，可以方便地进行市场营销中所需要的各项空间分析工作。</p>
<p>(2)GIS强大的空间分析与数据管理功能方便地实现商圈信息中的各项查询、检索工作，利用其可视化输出模块实现有关信息的多种形式的输出，以提供决策支持。</p>
<p>(3)GIS应用于商圈研究可提高效率、准确度，客观有效地进行辅助决策，实现决策的自动化和智能化。</p>
<p>(4)利用GIS可进行商圈决策的实时动态模拟及预测，GIS与商圈分析模型结合可提高商业活动的管理，为商业营销提供高新信息技术支撑。
GIS的发展及应用是现代信息论、系统论和计算机科学技术的有机结合.其应用一方面提高了作业效率和成果质量.另一方面节约了人力、物力、财力，在信息共享、信息充分利用方面具有无与伦比的优越性，是现代商业信息管理和决策依据的重要工具。
GIS在商业领域中具有重要的应用价值和广阔的应用空间，它为商业分析、网点选址、规划布局提供了集成分析和方案试验的环境.GIS技术的商业应用促进了地理区位分析方法的业务化发展，为新的商圈分析提供了试验所需的丰富的数据环境.GIS技术的应用合理规划了商圈资源、市场需求分析、对商圈规模的控制有良好的影响.GIS技术在商业活动中的作用将会越来越突出。</p>

</article>

<div class="content_post_button">
    
    <button onclick="window.location.href = '\/blog\/html\/'">
        <span style="color: var(--primary-color);">上一篇</span><br />HTML语言
    </button>
    
    
    <button onclick="window.location.href = '\/blog\/%E5%9F%BA%E4%BA%8E%E5%9F%BA%E4%BA%8Earcgis%E7%9A%84%E5%9C%B0%E5%9B%BE%E5%8F%91%E5%B8%83\/'">
        <span style="color: var(--primary-color);">下一篇</span><br />基于基于ArcGis的地图发布
    </button>
    
</div>
<a class="back_top" href="javascript:window.scrollTo(0,0);">
    <svg t="1660722824713" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
        p-id="1359" width="64" height="64">
        <path
            d="M484 93.668c-231.038 0-418.333 187.296-418.333 418.335 0 231.038 187.296 418.327 418.333 418.327 231.036 0 418.333-187.289 418.333-418.327C902.334 280.964 715.036 93.668 484 93.668zM372.207 811.881c-0.412 8.174-4.906 12.669-13.493 13.493-6.545 0-11.863-0.614-15.946-1.841-4.504-1.639-6.545-4.906-6.133-9.813 1.629-4.906 4.695-7.148 9.199-6.746 6.948 1.639 10.215 0.613 9.813-3.066l0-96.902-12.266 0c-4.504-0.402-6.746-3.268-6.746-8.586 0.402-4.907 2.855-7.562 7.359-7.974l36.185 0c2.453 0 4.083 1.025 4.906 3.066 1.227-2.855 3.469-4.494 6.747-4.906l82.183 0c4.495 0.412 6.747 3.277 6.747 8.587-0.412 5.318-2.865 8.184-7.36 8.586l-36.798 0-2.453 11.652 23.919 0c10.215-0.402 14.92 3.891 14.106 12.88l0 63.17c-0.412 4.504-3.277 6.957-8.586 7.36-5.318-0.403-8.184-2.856-8.586-7.36l0-57.037c0-1.227-0.613-1.84-1.84-1.84l-43.545 0c-0.824 0.412-1.438 1.025-1.84 1.84l0 55.811c-0.412 4.906-3.277 7.57-8.586 7.974-5.318-0.403-8.184-3.067-8.586-7.974l0-61.943c0-8.586 3.68-12.88 11.04-12.88l14.719 0 3.066-11.652-25.759 0c-2.453 0-5.117-1.016-7.973-3.066-1.227 2.865-3.479 4.293-6.746 4.293l-6.747 0L372.207 811.881zM479.536 824.146c-3.277 4.907-7.571 5.722-12.879 2.454-2.865-1.227-7.571-3.891-14.106-7.974-6.133-3.277-10.838-5.52-14.106-6.746-6.133-2.855-8.586-6.334-7.359-10.426-1.227 2.051-3.68 4.504-7.36 7.359-0.412 0.412-0.824 0.824-1.227 1.227-9.41 7.762-20.239 13.896-32.505 18.399-5.73 1.629-9.813 0.201-12.266-4.294-1.639-4.906 0-8.586 4.906-11.039 18.802-7.762 30.253-15.534 34.345-23.306 4.494-7.359 6.746-21.054 6.746-41.091 0.403-5.722 3.067-8.788 7.973-9.2 5.309 0.412 8.174 3.479 8.586 9.2 0.814 20.852-1.639 36.798-7.36 47.837 4.083-4.906 9.401-5.107 15.946-0.613 4.907 2.865 11.442 6.546 19.626 11.04 3.68 2.453 6.334 4.092 7.973 4.906C481.375 814.736 482.391 818.828 479.536 824.146zM556.198 822.307l-41.704 0c-7.772-0.412-11.864-3.891-12.267-10.426l0-34.345c-0.412-8.989 3.68-13.282 12.267-12.88l42.931 0c7.763-0.402 11.653 3.891 11.653 12.88l0 34.958C569.48 819.029 565.188 822.307 556.198 822.307zM614.462 817.4c-6.545 0-11.652-0.824-15.332-2.453-4.092-2.051-5.318-5.309-3.68-9.813 1.629-4.906 5.107-6.747 10.426-5.52 11.04 2.453 15.735-1.841 14.106-12.88-0.412-8.174-5.933-18.399-16.56-30.665-3.68-3.68-4.293-9.2-1.84-16.56 4.494-13.895 7.561-24.532 9.199-31.892l-16.559 0c-1.227 0-2.051 0.824-2.453 2.453l0 110.395c-0.412 5.31-3.067 8.175-7.974 8.587-5.318-0.412-8.184-3.277-8.586-8.587l0-65.01c-1.227 1.639-2.865 2.453-4.906 2.453l-69.304 0c-4.504-0.402-6.957-3.268-7.359-8.586 0.402-5.31 2.855-8.175 7.359-8.587l14.72 0c-0.824-0.814-3.68-5.721-8.586-14.719-2.051-5.31-0.613-8.989 4.293-11.04l-7.36 0c-4.504-0.402-6.957-3.268-7.359-8.586 0.402-5.309 2.855-8.174 7.359-8.586l22.079 0c-0.824-1.227-1.227-2.453-1.227-3.681-1.227-4.082 0.613-7.359 5.52-9.813 5.721-2.041 9.401-1.016 11.04 3.066 1.227 3.68 2.654 7.158 4.293 10.427l20.239 0c4.494 0.412 6.947 3.277 7.359 8.586-0.412 5.318-2.865 8.184-7.359 8.586l-47.225 0c2.855 1.639 6.334 7.36 10.426 17.173 1.227 4.092 0.814 6.957-1.227 8.586l13.493 0c0.402-1.227 1.016-2.855 1.84-4.906 2.453-6.133 4.082-11.039 4.906-14.72 1.629-4.082 5.107-5.721 10.426-4.906 4.906 2.051 6.747 5.318 5.521 9.813-0.824 2.051-1.639 4.504-2.454 7.359-1.227 3.277-2.252 5.932-3.066 7.973l11.04 0c2.453 0 4.082 0.613 4.906 1.84l0-41.704c0-8.175 3.066-12.056 9.199-11.653l36.799 0c9.4 0 13.08 5.117 11.039 15.333 0 0.412-1.025 3.891-3.066 10.426-3.277 10.226-5.52 17.786-6.746 22.692-1.227 3.68-1.84 6.344-1.84 7.973 0.402 1.228 1.629 3.067 3.68 5.521 8.586 13.09 13.281 25.356 14.105 36.798C638.17 807.387 630.408 816.988 614.462 817.4zM646.896 466.315c-7.488 7.449-18.815 7.642-25.649 0.806-0.538-0.537-1.074-0.922-1.536-1.535L502.752 348.858l-0.192 280.106c0 9.139-8.601 16.549-19.198 16.549-10.598 0-18.738-7.41-18.738-16.549 0-0.729-0.115-1.306 0-2.034l-0.192-278.072L347.513 465.586c-0.422 0.652-0.959 0.999-1.536 1.535-6.834 6.874-18.162 6.681-25.649-0.806-7.488-7.488-8.025-19.122-1.152-25.995L467.12 292.03c2.112-3.263 5.26-5.913 9.369-7.333 2.074-0.807 4.262-1.152 6.528-1.113 0.23 0 0.383-0.116 0.614-0.116 0.153 0 0.307 0.078 0.46 0.078 2.304-0.078 4.57 0.307 6.72 1.152 3.994 1.421 7.142 4.07 9.254 7.219L648.048 440.32C654.92 447.155 654.383 458.827 646.896 466.315zM636.605 238.121 331.771 238.121c-9.407 0-17.049-7.564-17.049-16.857 0-9.292 7.642-16.856 17.049-16.856l304.835 0c9.445 0 17.048 7.564 17.048 16.856C653.653 230.557 646.013 238.121 636.605 238.121zM549.452 781.829 521.24 781.829c-1.227 0-2.051 0.824-2.453 2.453l0 19.013c0.402 1.639 1.227 2.453 2.453 2.453l28.212 0c1.629-0.402 2.453-1.227 2.453-2.453l0-19.013C551.905 782.653 551.081 781.829 549.452 781.829z"
            p-id="1360" fill="#343232"></path>
    </svg>
</a>


    <div class="center_main_contents_title">
    <h2>目录</h2>
</div>
<div class="center_main_contents_main">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#一绪论">一．绪论</a></li>
    <li><a href="#二理论基础">二．理论基础</a></li>
    <li><a href="#三设计步骤">三．设计步骤</a>
      <ul>
        <li><a href="#1-获取研究区域咖啡馆信息并绘制表格">1. 获取研究区域咖啡馆信息，并绘制表格</a></li>
        <li><a href="#2-导入数据">2. 导入数据</a></li>
        <li><a href="#3-要素转换">3. 要素转换</a></li>
        <li><a href="#4-创建缓冲区">4. 创建缓冲区</a></li>
        <li><a href="#5--创建泰森多边形">5.  创建泰森多边形</a></li>
        <li><a href="#6--对栅格人口及泰森多边形计算每个单元数据的面积">6.  对栅格人口及泰森多边形计算每个单元数据的面积</a></li>
        <li><a href="#7--栅格人口数据与泰森多边形数据的交叉计算">7.  栅格人口数据与泰森多边形数据的交叉计算</a></li>
        <li><a href="#8--交叉区域的人口估算">8.  交叉区域的人口估算</a></li>
        <li><a href="#9--泰森多边形商圈的人口估算">9.  泰森多边形商圈的人口估算</a></li>
        <li><a href="#10-商圈缓冲区内的公交站数的计算">10. 商圈缓冲区内的公交站数的计算</a></li>
      </ul>
    </li>
    <li><a href="#四成果展示">四．成果展示</a>
      <ul>
        <li><a href="#1独立等距缓冲区和融合等距缓冲区">1.独立等距缓冲区和融合等距缓冲区</a></li>
        <li><a href="#2等时圈分布">2.等时圈分布</a></li>
        <li><a href="#3泰森多边形商圈的人口密度分布图">3.泰森多边形商圈的人口密度分布图</a></li>
        <li><a href="#4商圈缓冲区的公交站数分布图">4.商圈缓冲区的公交站数分布图</a></li>
      </ul>
    </li>
    <li><a href="#五-不足与展望">五． 不足与展望</a>
      <ul>
        <li><a href="#1设计过程中碰到的问题及解决办法">1.设计过程中碰到的问题及解决办法</a></li>
        <li><a href="#2本设计能够应用在哪些方面解决哪些问题">2.本设计能够应用在哪些方面、解决哪些问题</a></li>
        <li><a href="#3gis-在商圈分析中还有哪些应用">3.GIS 在商圈分析中还有哪些应用</a></li>
      </ul>
    </li>
  </ul>
</nav>
</div>
</div>

</div>
</body>





</html>